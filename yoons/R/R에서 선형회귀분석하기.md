
#  Plot
R 언어에서 `plot` 함수는 데이터를 시각화하기 위한 기본적인 그래프를 그리는 데 사용되는 함수다. `plot` 함수를 사용하여 산점도, 선 그래프, 막대 그래프, 상자 그림 등 다양한 종류의 그래프를 생성할 수 있다. 

![[스크린샷 2023-11-27 오전 9.57.03.png]]


# lm
`lm` 함수는 선형 회귀(Linear Regression) 모델을 적합시키는 데 사용되는 함수다. 선형 회귀는 종속 변수와 하나 이상의 독립 변수 간의 관계를 모델링하는 통계적 기법으로, 데이터의 패턴을 분석하고 예측하는 데 사용됩니다. `lm` 함수를 사용하여 선형 회귀 모델을 만들고 추정할 수 있다.

```R
lm(myData$Earnings ~ myData$Cost))
```
다음과 같은 방법으로  모델을 만들 수 있다.
해당 모델은 종속변수 Earnings와 독립변수 Cost간의 선형회귀 모델이라고 할 수 있다.


# summary

`summary` 함수로 모델 요약을 확인할 수 있습니다. 요약 정보에는 회귀 계수, 설명력(R-squared), 잔차 등의 통계적 정보가 포함된다.


![[스크린샷 2023-11-27 오전 10.21.35.png]]

위에서 각 독립 변수들의 추정 회귀 계수를 알 수 있다.


# 다중 선형 회귀 분석하기

```R
mod3 <- lm(Earnings ~ Cost + Grad + Debt + City, data=myData)
anova(mod3)
```
위 코드는 아래의 출력을 가져온다.
![[스크린샷 2023-11-29 오전 1.18.41.png]]
이때 각 열의 의미는 다음과 같다.

1. `Df` (자유도, Degrees of Freedom): 분산 분석의 자유도는 모델 내의 자유도와 모델 간의 자유도를 나타낸다. 모델 내 자유도는 오차 또는 잔차에 대한 자유도이며 모델 간 자유도는 그룹 간 자유도를 나타낸다. 이때 각 데이터들의 Df가 1이기 때문에 통계적인 차이를 볼 수 있다.
   
    
2. `Sum_Sq` (제곱합, Sum of Squares): 각 모델 내의 분산 합계 및 모델 간의 분산 합계를 나타냅니다. 이러한 합계는 ANOVA의 주요 계산에 사용된다. 
	각 
    
3. `Mean_Sq` (평균제곱, Mean Square): 제곱합을 자유도로 나눈 것으로, 분산을 나타낸다. 모델 내 평균 제곱은 오차 분산을 나타내며 모델 간 평균 제곱은 그룹 간 분산을 나타낸다.
    
4. `F_value` (F-값): F-통계량은 모델 간 평균 제곱과 모델 내 평균 제곱의 비율로, 그룹 간 평균 차이의 통계적 유의성을 나타낸다.. 높은 F-값은 그룹 간 차이가 통계적으로 유의미함을 나타낼 수 있다.
    
5. `Pr(>F)` (p-값): F-통계량에 대한 p-값은 F-분포 아래의 확률을 나타낸다. 작은 p-값은 그룹 간 차이가 통계적으로 유의미하다는 것을 나타냅니다. 일반적으로 p-값이 0.05 미만이면 그룹 간 차이가 통계적으로 유의미하다고 간주됩니다.

## 모델간의 분산을 분석하고 싶을 때
```R
mod0 <- lm(Earnings ~ 1, data=myData)
mod3 <- lm(Earnings ~ Cost + Grad + Debt + City, data = myData)
anova(mod0,mod3)
```
다음의 결과 값은 다음과 같다.
![[스크린샷 2023-11-29 오전 2.20.44.png]]

1. `Res.Df` (Residual Degrees of Freedom, 잔차 자유도): 잔차(오차)의 자유도. 이것은 모델 내에서 사용되지 않은 자유도를 나타낸다. 일반적으로 데이터 포인트의 총 개수에서 독립 변수의 개수 및 모델에서 추정된 모수의 수를 뺀 값입니다. 잔차 자유도는 모델 내 오차의 자유도를 나타낸다.
    
2. `RSS` (Residual Sum of Squares, 잔차 제곱합): 모델 내에서 설명할 수 없는 잔차(오차)의 제곱을 합한 값이다. 즉, 모델로 설명하지 못한 데이터의 변동성을 나타낸다. 더 낮은 잔차 제곱합은 모델의 적합도를 나타내며, 모델이 데이터를 얼마나 잘 설명하는지를 반영한다.
    
3. `Df` (Degrees of Freedom, 자유도): 자유도는 모델 간, 모델 내 또는 오차의 자유도를 나타낸다. 이 값은 모델에서 추정된 모수의 수와 관련이 있다.
    
4. `Sum of Sq` (Sum of Squares, 제곱합): 모델 간 분산합계 (SS_Model) 또는 모델 내 분산합계 (SS_Residual)를 나타낸다. 모델 간 분산합계는 독립 변수 간의 변동성을 나타내며, 모델 내 분산합계는 모델로 설명하지 못한 잔차의 변동성을 나타낸다..
    
5. `F` (F-statistic, F-통계량): 모델 간 평균 제곱을 모델 내 평균 제곱으로 나눈 값으로, 모델 간 그룹 간 차이의 통계적 유의성을 나타낸다. F-통계량이 크면 그룹 간 차이가 통계적으로 유의미하다는 것을 나타낸다..
6. `Pr(>F)` (p-value, p-값): F-통계량에 대한 p-값은 F-분포에서 얻은 확률을 나타냅니다. 작은 p-값은 그룹 간 차이가 통계적으로 유의미하다는 것을 나타냅니다. p-값을 통해 가설 검정 결과를 판단할 수 있습니다. 일반적으로 p-값이 0.05 미만이면 통계적으로 유의한 차이가 있다고 판단된다.



## 상관관계 분석

- 코드
```R
library(dplyr)
myData <- myData %>%
  select(-State)
round(cor(myData),3)
```
- 출력
![[스크린샷 2023-11-29 오전 2.57.03.png]]
1. 데이터 프레임에서 State 열을 제외한다. (Home_values 시트의 state 열을 제외)
2. cor 함수를 통해 데이터 프레임 내의 모든 숫자 열 간의 상관 관계를 계산한다. (-1 부터 1사이)
3. round 함수를 이용하여 상관관계 행렬의 모든 숫자를 소수점 세 자리까지 반올림하여 출력한다.


## 회귀 분석모델 결과 비교하기
- 입력
```R
### Home_Values
myData <- read_excel("jaggia_ba_1e_ch06.xlsx", sheet = "Home_Values")

library(dplyr)
myData <- myData %>%
  select(-State)
round(cor(myData),3)

library(jtools)
library(huxtable)

mod1<-lm(`Home Value`~`HH Inc`+`Per Cap Inc`+`Pct Owner Occ`,data=myData)
mod2<-lm(`Home Value`~`HH Inc`+`Pct Owner Occ`,data=myData)
mod3<-lm(`Home Value`~`Per Cap Inc`+`Pct Owner Occ`,data=myData)

export_summs(mod1,mod2,mod3)
```

- 출력
![[스크린샷 2023-11-29 오전 3.14.47.png]]

다음 분석 결과의 내용을 설명하면 다음과 같다.

**모델 1:**

- 절편(intercept)의 값은 28375.41이며, 뒤에 별표를 통해 이는 매우 유의하다는 것을 나타내는 p-값 < 0.001을 가진다는 것을 알 수있다.
- 'Cost' 변수의 회귀계수는 0.72로, 이 역시 매우 유의하다는 것을 나타내는 p-값 < 0.001을 가집니다.
- 모델의 관측치(N)는 116개이며, 결정계수(R²)는 0.28이다. 이는 모델이 데이터의 28%만 설명한다는 것을 의미한다.

**모델 2:**

- 절편의 값은 11819.47이며, p-값 < 0.001을 가진다.
- 'Cost' 변수의 계수는 0.50으로, 역시 p-값 < 0.001을 가진다.
- 'Grad' 변수의 계수는 192.67로, p-값 < 0.01을 가진다.
- 'Debt' 변수는 포함되지만 통계적으로 유의하지 않다.(p-값 > 0.05).
- 이 모델의 결정계수(R²)는 0.40입니다, 즉 40%의 데이터 변동성을 설명한다.

**모델 3:**

- 절편의 값은 10004.97이며, p-값 < 0.001을 가진다.
- 'Cost' 변수의 계수는 0.43으로, 역시 p-값 < 0.001을 가진다.
- 'Grad' 변수의 계수는 178.10으로, p-값 < 0.05을 가진다.
- 'Debt' 변수의 계수는 141.48이지만, 유의하지 않습니다(p-값 > 0.05).
- 'City' 변수의 계수는 2526.79로, p-값 < 0.05을 가진다.
- 이 모델의 결정계수(R²)는 0.43입니다, 즉 43%의 데이터 변동성을 설명한다.

최종적으로 보았을 떄,